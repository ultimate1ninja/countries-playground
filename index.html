<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>World Countries Explorer (Pakistan View)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f8f9fa; }
    h1 { text-align: center; }
    #controls { text-align: center; margin-bottom: 20px; }
    select, input { padding: 6px; margin: 5px; }
    #countries { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; }
    .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); transition: transform 0.2s; }
    .card:hover { transform: scale(1.03); }
    .flag { width: 100%; height: 150px; object-fit: cover; border-radius: 8px; margin-bottom: 10px; }
    .card h2 { margin: 5px 0; font-size: 18px; }
    .card p { margin: 3px 0; font-size: 14px; }
  </style>
</head>
<body>
  <h1>üåç World Countries Explorer (üáµüá∞ View)</h1>
  <div id="controls">
    <input type="text" id="search" placeholder="Search country...">
    <select id="regionFilter">
      <option value="">All Regions</option>
      <option>Africa</option>
      <option>Americas</option>
      <option>Asia</option>
      <option>Europe</option>
      <option>Oceania</option>
    </select>
  </div>
  <div id="countries"></div>

  <script>
    let ALL = [];

    // Countries Pakistan does not recognize
    const PK_UNRECOGNIZED = ["Israel", "Armenia", "Taiwan"];

    // Western Sahara (SADR) to add manually
    const WESTERN_SAHARA = {
      name: "Western Sahara",
      cca2: "EH",
      region: "Africa",
      subregion: "Northern Africa",
      capital: ["Laayoune"],
      population: null,
      area: null,
      languages: ["Arabic", "Berber"],
      flagPng: "https://flagcdn.com/w320/eh.png"
    };

    // Fetch all countries
    fetch("https://restcountries.com/v3.1/all")
      .then(res => res.json())
      .then(json => {
        ALL = json.map(c => {
          const name = c.name?.common || c.name?.official || c.cca3 || "Unknown";
          const cca2 = (c.cca2 || "").toUpperCase();
          const region = c.region || "Other";
          const subregion = c.subregion || "";
          const capital = Array.isArray(c.capital) ? c.capital : (c.capital ? [c.capital] : []);
          const population = (typeof c.population === "number" ? c.population : null);
          const area = (typeof c.area === "number" ? c.area : null);
          const languages = c.languages ? Object.values(c.languages) : [];
          const flagPng = cca2 ? `https://flagcdn.com/w320/${cca2.toLowerCase()}.png` : "";
          return { name, cca2, region, subregion, capital, population, area, languages, flagPng };
        });

        // Remove countries PK does not recognize
        ALL = ALL.filter(c => !PK_UNRECOGNIZED.includes(c.name));

        // Add Western Sahara if missing
        if (!ALL.some(c => c.name === "Western Sahara")) {
          ALL.push(WESTERN_SAHARA);
        }

        render();
      });

    // Render countries
    function render() {
      const search = document.getElementById("search").value.toLowerCase();
      const region = document.getElementById("regionFilter").value;
      const container = document.getElementById("countries");
      container.innerHTML = "";

      let filtered = ALL.filter(c => 
        c.name.toLowerCase().includes(search) &&
        (!region || c.region === region)
      );

      filtered.sort((a,b) => a.name.localeCompare(b.name));

      for (const c of filtered) {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${c.flagPng}" alt="Flag of ${c.name}" class="flag">
          <h2>${c.name}</h2>
          <p><b>Region:</b> ${c.region} ${c.subregion ? "(" + c.subregion + ")" : ""}</p>
          <p><b>Capital:</b> ${c.capital.length ? c.capital.join(", ") : "N/A"}</p>
          <p><b>Population:</b> ${c.population ? c.population.toLocaleString() : "N/A"}</p>
          <p><b>Area:</b> ${c.area ? c.area.toLocaleString() + " km¬≤" : "N/A"}</p>
          <p><b>Languages:</b> ${c.languages.length ? c.languages.join(", ") : "N/A"}</p>
        `;
        container.appendChild(card);
      }
    }

    // Filters
    document.getElementById("search").addEventListener("input", render);
    document.getElementById("regionFilter").addEventListener("change", render);
  </script>
</body>
</html>
